# 現在可以做的任務清單

**生成時間**：2024年12月  
**項目狀態**：MVP核心功能完成95%，準備進入測試和部署階段

---

## 🎯 立即可做的任務（按優先級排序）

### 🔥 高優先級（P0）- 核心功能完善

#### 1. 完成證據上傳功能集成 ⏱️ 2-3小時 ✅ **已完成**

**現狀**：
- ✅ 後端API已實現（`/api/v1/cases/:id/evidence`）
- ✅ 前端FileUpload組件已實現
- ✅ 前端組件已集成API調用
- ✅ 案件創建後自動上傳證據功能已實現

**已完成**：
1. ✅ 修改 `frontend/src/components/business/FileUpload/index.tsx`
   - ✅ 添加 `caseId` 和 `sessionId` 屬性支持
   - ✅ 實現實際上傳功能（`handleActualUpload`）
   - ✅ 處理上傳進度和錯誤
   - ✅ 支持本地預覽模式（無caseId時）和實際上傳模式（有caseId時）

2. ✅ 更新案件創建頁面
   - ✅ `QuickExperience/Create` 頁面：案件創建後自動上傳證據
   - ✅ `Case/Create` 頁面：案件創建後自動上傳證據

3. ✅ 更新API服務
   - ✅ `uploadEvidence` 函數支持 `sessionId` 參數

**文件位置**：
- ✅ `frontend/src/components/business/FileUpload/index.tsx` - 已更新
- ✅ `frontend/src/services/api/case.ts` - 已更新
- ✅ `frontend/src/pages/QuickExperience/Create/index.tsx` - 已更新
- ✅ `frontend/src/pages/Case/Create/index.tsx` - 已更新

---

#### 2. 創建環境變量示例文件 ⏱️ 30分鐘 ✅ **已完成**

**現狀**：
- ✅ 已創建 `.env.example` 文件
- ✅ 包含所有必需的環境變量
- ✅ 包含詳細的註釋和說明

**已完成**：
1. ✅ 創建 `backend/.env.example`
   - ✅ 包含所有必需的環境變量（數據庫、JWT、OpenAI等）
   - ✅ 包含可選的環境變量（郵件服務等，帶註釋）
   - ✅ 包含示例值和詳細說明

2. ✅ 創建 `frontend/.env.example`
   - ✅ 包含API基礎URL配置
   - ✅ 包含應用配置
   - ✅ 包含可選的分析工具配置

**文件位置**：
- ✅ `backend/.env.example` - 已創建
- ✅ `frontend/.env.example` - 已創建

**參考**：
- `backend/src/config/env.ts` - 查看所有需要的環境變量
- `frontend/vite.config.ts` - 查看前端環境變量配置

---

#### 3. 編寫基礎單元測試 ⏱️ 4-6小時 ✅ **已完成**

**現狀**：
- ✅ Jest已配置在 `package.json`
- ✅ 測試配置文件已創建
- ✅ 基礎單元測試已編寫

**已完成**：
1. ✅ 創建測試配置文件
   - ✅ `backend/jest.config.ts` - Jest配置完成
   - ✅ `backend/tests/setup.ts` - 測試環境設置

2. ✅ 編寫工具函數的單元測試：
   - ✅ `utils/password.ts` - 密碼加密和驗證測試
   - ✅ `utils/jwt.ts` - JWT生成/驗證測試
   - ✅ `utils/validation.ts` (helpers) - 郵箱和密碼驗證測試

**文件位置**：
- ✅ `backend/jest.config.ts` - 已創建
- ✅ `backend/tests/setup.ts` - 已創建
- ✅ `backend/tests/unit/utils/password.test.ts` - 已創建
- ✅ `backend/tests/unit/utils/jwt.test.ts` - 已創建
- ✅ `backend/tests/unit/utils/validation.test.ts` - 已創建

**目標**：
- ✅ 工具函數測試覆蓋率已達到基礎水平
- ⏳ 服務層測試待後續完善

---

### 🟡 中優先級（P1）- 部署和配置

#### 4. 創建部署腳本 ⏱️ 1-2小時 ✅ **已完成**

**現狀**：
- ✅ 有部署文檔（`backend/DEPLOYMENT.md`）
- ✅ 自動化部署腳本已創建

**已完成**：
1. ✅ 創建 `scripts/deploy.sh`
   - ✅ 環境檢查（Node.js版本）
   - ✅ 依賴安裝
   - ✅ 數據庫遷移
   - ✅ 構建項目
   - ✅ 部署準備完成提示

2. ✅ 創建 `scripts/setup-production.sh`
   - ✅ 生產環境初始化
   - ✅ 環境變量配置（從.example創建）
   - ✅ 必要目錄創建
   - ✅ 文件權限設置

3. ✅ 創建 `scripts/health-check.sh`
   - ✅ API服務健康檢查
   - ✅ 數據庫連接檢查
   - ✅ 前端構建檢查
   - ✅ PM2進程檢查

**文件位置**：
- ✅ `scripts/deploy.sh` - 已創建並設置執行權限
- ✅ `scripts/setup-production.sh` - 已創建並設置執行權限
- ✅ `scripts/health-check.sh` - 已創建並設置執行權限

---

#### 5. 配置生產環境變量模板 ⏱️ 1小時

**現狀**：
- ⚠️ 生產環境配置需要手動設置

**需要做**：
1. 創建 `backend/.env.production.example`
   - 生產環境專用配置
   - 安全建議
   - 性能優化配置

2. 創建 `frontend/.env.production.example`
   - 生產環境API URL
   - CDN配置
   - 分析工具配置

**文件位置**：
- `backend/.env.production.example` (新建)
- `frontend/.env.production.example` (新建)

---

#### 6. 創建Docker配置優化 ⏱️ 1-2小時

**現狀**：
- ✅ 有 `backend/Dockerfile`
- ⚠️ 可能缺少 `docker-compose.yml`

**需要做**：
1. 創建 `docker-compose.yml`
   - 後端服務
   - 數據庫服務
   - 可選：Redis服務

2. 創建 `docker-compose.prod.yml`
   - 生產環境配置
   - 網絡配置
   - 卷配置

3. 優化 `backend/Dockerfile`
   - 多階段構建
   - 緩存優化
   - 安全最佳實踐

**文件位置**：
- `docker-compose.yml` (新建)
- `docker-compose.prod.yml` (新建)
- `backend/Dockerfile` (優化)

---

### 🟢 低優先級（P2）- 優化和完善

#### 7. 編寫集成測試 ⏱️ 6-8小時

**現狀**：
- ⚠️ 集成測試為空

**需要做**：
1. 設置測試數據庫
   - 測試環境配置
   - 測試數據清理

2. 編寫API端到端測試：
   - 認證流程測試
   - 案件創建流程測試
   - 判決生成流程測試
   - 和好方案流程測試

**文件位置**：
- `backend/tests/integration/auth.test.ts` (新建)
- `backend/tests/integration/case.test.ts` (新建)
- `backend/tests/integration/judgment.test.ts` (新建)

---

#### 8. 創建CI/CD配置 ⏱️ 2-3小時

**現狀**：
- ⚠️ 缺少CI/CD配置

**需要做**：
1. 創建 `.github/workflows/ci.yml`
   - 代碼檢查
   - 單元測試
   - 構建驗證

2. 創建 `.github/workflows/cd.yml`
   - 自動部署
   - 環境變量管理

**文件位置**：
- `.github/workflows/ci.yml` (新建)
- `.github/workflows/cd.yml` (新建)

---

#### 9. 添加API文檔自動生成 ⏱️ 2-3小時

**現狀**：
- ✅ 有手動API文檔（`backend/API.md`）
- ⚠️ 缺少自動生成的API文檔

**需要做**：
1. 安裝 Swagger/OpenAPI
   - `swagger-jsdoc`
   - `swagger-ui-express`

2. 添加API註釋
   - 路由註釋
   - 參數註釋
   - 響應註釋

3. 生成API文檔
   - 訪問 `/api-docs` 查看文檔

**文件位置**：
- `backend/src/config/swagger.ts` (新建)
- `backend/src/app.ts` (添加Swagger中間件)

---

#### 10. 創建開發者快速入門指南 ⏱️ 1-2小時

**現狀**：
- ✅ 有各種文檔
- ⚠️ 缺少統一的快速入門指南

**需要做**：
1. 創建 `QUICK_START.md`
   - 5分鐘快速啟動
   - 環境配置
   - 常見問題

2. 創建 `CONTRIBUTING.md`
   - 貢獻指南
   - 代碼規範
   - 提交流程

**文件位置**：
- `QUICK_START.md` (新建或更新)
- `CONTRIBUTING.md` (新建)

---

## 📋 任務執行建議

### 本週可以完成（推薦順序）

1. **證據上傳功能集成** (2-3小時) - 🔥 最高優先級
2. **創建環境變量示例文件** (30分鐘) - 🔥 快速完成
3. **編寫基礎單元測試** (4-6小時) - 🔥 重要但可分批完成

### 下週可以完成

4. **創建部署腳本** (1-2小時)
5. **配置生產環境變量模板** (1小時)
6. **創建Docker配置優化** (1-2小時)

### 後續可以完成

7. **編寫集成測試** (6-8小時)
8. **創建CI/CD配置** (2-3小時)
9. **添加API文檔自動生成** (2-3小時)
10. **創建開發者快速入門指南** (1-2小時)

---

## 🎯 快速開始（推薦）

### 立即開始（今天）

1. **證據上傳功能集成** ⏱️ 2-3小時
   ```bash
   # 1. 修改 FileUpload 組件
   # 2. 測試上傳功能
   # 3. 驗證文件保存
   ```

2. **創建環境變量示例文件** ⏱️ 30分鐘
   ```bash
   # 1. 創建 backend/.env.example
   # 2. 創建 frontend/.env.example
   ```

### 本週完成

3. **編寫基礎單元測試** ⏱️ 4-6小時
   ```bash
   # 1. 配置 Jest
   # 2. 編寫核心服務測試
   # 3. 運行測試驗證
   ```

---

## 💡 額外建議

### 如果時間充裕，還可以：

1. **性能優化檢查**
   - 數據庫查詢優化
   - API響應時間優化
   - 前端打包大小優化

2. **安全審查**
   - 依賴漏洞掃描
   - 安全頭配置檢查
   - 輸入驗證覆蓋檢查

3. **文檔完善**
   - API文檔補充
   - 錯誤碼文檔
   - 故障排查指南

4. **監控準備**
   - Sentry錯誤監控配置
   - 性能監控配置
   - 日誌聚合配置

---

## 📊 任務完成後的效果

### 完成高優先級任務後：
- ✅ 證據上傳功能完全可用
- ✅ 新開發者可以快速上手
- ✅ 核心邏輯有測試保障

### 完成中優先級任務後：
- ✅ 可以快速部署到生產環境
- ✅ 部署流程自動化
- ✅ 環境配置標準化

### 完成低優先級任務後：
- ✅ 代碼質量有保障
- ✅ 持續集成/部署自動化
- ✅ API文檔自動更新

---

## 🚀 開始行動

**建議從以下任務開始**：

1. **證據上傳功能集成** - 這是唯一未完成的核心功能
2. **創建環境變量示例文件** - 快速完成，立即見效
3. **編寫基礎單元測試** - 提升代碼質量

**預計總時間**：6-10小時（1-2天）

---

**最後更新**：2024年12月

