# éƒ¨ç½²å’Œé‹ç¶­

**æ–‡æª”ç‰ˆæœ¬**ï¼šv1.0  
**æœ€å¾Œæ›´æ–°**ï¼š2024å¹´

---

## ğŸš€ éƒ¨ç½²æ¦‚è¿°

### éƒ¨ç½²ç’°å¢ƒ

- **é–‹ç™¼ç’°å¢ƒ**ï¼šæœ¬åœ°é–‹ç™¼
- **æ¸¬è©¦ç’°å¢ƒ**ï¼šRailway/Renderæ¸¬è©¦å¯¦ä¾‹
- **ç”Ÿç”¢ç’°å¢ƒ**ï¼šRailway/Renderç”Ÿç”¢å¯¦ä¾‹

### éƒ¨ç½²å¹³å°

- **æ¨è–¦**ï¼šRailwayï¼ˆå…è²»é¡åº¦ï¼Œæ˜“æ–¼ä½¿ç”¨ï¼‰
- **å‚™é¸**ï¼šRenderï¼ˆå…è²»ç‰ˆï¼ŒåŠŸèƒ½å®Œæ•´ï¼‰

---

## ğŸ“¦ ç’°å¢ƒé…ç½®

### ç’°å¢ƒè®Šé‡

**æ–‡ä»¶**ï¼š`.env.example`

```env
# æœå‹™å™¨é…ç½®
NODE_ENV=production
PORT=3000

# æ•¸æ“šåº«é…ç½®
DATABASE_URL=postgresql://user:password@host:5432/dbname

# JWTé…ç½®
JWT_SECRET=your-secret-key-change-in-production
JWT_EXPIRES_IN=7d

# OpenAIé…ç½®
OPENAI_API_KEY=sk-...
OPENAI_MODEL=gpt-3.5-turbo
OPENAI_MAX_TOKENS=2000
OPENAI_DAILY_LIMIT=1000

# éƒµä»¶é…ç½®
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your-email@gmail.com
SMTP_PASS=your-password
EMAIL_FROM=noreply@motherbearcourt.com

# æ–‡ä»¶å­˜å„²é…ç½®
CLOUDINARY_CLOUD_NAME=your-cloud-name
CLOUDINARY_API_KEY=your-api-key
CLOUDINARY_API_SECRET=your-api-secret

# å‰ç«¯URL
FRONTEND_URL=https://motherbearcourt.com

# å…è¨±çš„ä¾†æº
ALLOWED_ORIGINS=https://motherbearcourt.com,https://www.motherbearcourt.com

# æ—¥èªŒç´šåˆ¥
LOG_LEVEL=info
```

---

## ğŸ—ï¸ éƒ¨ç½²æµç¨‹

### 1. æº–å‚™å·¥ä½œ

```bash
# 1. ç¢ºä¿ä»£ç¢¼å·²æäº¤åˆ°Git
git add .
git commit -m "Ready for deployment"
git push origin main

# 2. é‹è¡Œæ¸¬è©¦
npm run test

# 3. æ§‹å»ºé …ç›®
npm run build
```

### 2. Railwayéƒ¨ç½²

**æ­¥é©Ÿ**ï¼š

1. åœ¨Railwayå‰µå»ºæ–°é …ç›®
2. é€£æ¥GitHubå€‰åº«
3. é…ç½®ç’°å¢ƒè®Šé‡
4. éƒ¨ç½²

**Railwayé…ç½®**ï¼š

```json
{
  "build": {
    "builder": "NIXPACKS"
  },
  "deploy": {
    "startCommand": "npm start",
    "restartPolicyType": "ON_FAILURE",
    "restartPolicyMaxRetries": 10
  }
}
```

### 3. Renderéƒ¨ç½²

**æ­¥é©Ÿ**ï¼š

1. åœ¨Renderå‰µå»ºæ–°Webæœå‹™
2. é€£æ¥GitHubå€‰åº«
3. é…ç½®æ§‹å»ºå‘½ä»¤ï¼š`npm install && npm run build`
4. é…ç½®å•Ÿå‹•å‘½ä»¤ï¼š`npm start`
5. é…ç½®ç’°å¢ƒè®Šé‡
6. éƒ¨ç½²

---

## ğŸ—„ï¸ æ•¸æ“šåº«éƒ¨ç½²

### Supabaseè¨­ç½®

1. å‰µå»ºSupabaseé …ç›®
2. ç²å–æ•¸æ“šåº«é€£æ¥å­—ç¬¦ä¸²
3. é‹è¡Œé·ç§»ï¼š

```bash
# è¨­ç½®æ•¸æ“šåº«URL
export DATABASE_URL="postgresql://..."

# é‹è¡Œé·ç§»
npx prisma migrate deploy
```

### æ•¸æ“šåº«é·ç§»

```bash
# é–‹ç™¼ç’°å¢ƒï¼šå‰µå»ºé·ç§»
npx prisma migrate dev --name migration_name

# ç”Ÿç”¢ç’°å¢ƒï¼šæ‡‰ç”¨é·ç§»
npx prisma migrate deploy
```

---

## ğŸ“Š ç›£æ§å’Œæ—¥èªŒ

### æ—¥èªŒç®¡ç†

**æœ¬åœ°æ—¥èªŒ**ï¼š
- éŒ¯èª¤æ—¥èªŒï¼š`logs/error.log`
- æ‰€æœ‰æ—¥èªŒï¼š`logs/combined.log`

**ç”Ÿç”¢ç’°å¢ƒ**ï¼š
- Railway/Renderæä¾›å…§å»ºæ—¥èªŒæŸ¥çœ‹
- å¯é›†æˆSentryé€²è¡ŒéŒ¯èª¤è¿½è¹¤

### æ€§èƒ½ç›£æ§

**é—œéµæŒ‡æ¨™**ï¼š
- APIéŸ¿æ‡‰æ™‚é–“
- æ•¸æ“šåº«æŸ¥è©¢æ™‚é–“
- AIæœå‹™èª¿ç”¨æ™‚é–“
- éŒ¯èª¤ç‡

**ç›£æ§å·¥å…·**ï¼š
- Railway/Renderå…§å»ºç›£æ§
- å¯é¸ï¼šNew Relicã€Datadog

---

## ğŸ”§ é‹ç¶­ä»»å‹™

### æ—¥å¸¸ç¶­è­·

1. **æ—¥èªŒæª¢æŸ¥**ï¼šæ¯æ—¥æª¢æŸ¥éŒ¯èª¤æ—¥èªŒ
2. **æ€§èƒ½ç›£æ§**ï¼šç›£æ§APIéŸ¿æ‡‰æ™‚é–“
3. **æˆæœ¬ç›£æ§**ï¼šç›£æ§OpenAI APIä½¿ç”¨é‡
4. **å‚™ä»½æª¢æŸ¥**ï¼šç¢ºèªæ•¸æ“šåº«å‚™ä»½æ­£å¸¸

### å®šæœŸä»»å‹™

1. **æ•¸æ“šæ¸…ç†**ï¼šæ¸…ç†éæœŸæ•¸æ“š
2. **ç·©å­˜æ¸…ç†**ï¼šæ¸…ç†éæœŸç·©å­˜
3. **å®‰å…¨æ›´æ–°**ï¼šæ›´æ–°ä¾è³´åŒ…
4. **æ€§èƒ½å„ªåŒ–**ï¼šæ ¹æ“šç›£æ§æ•¸æ“šå„ªåŒ–

---

## ğŸš¨ æ•…éšœè™•ç†

### å¸¸è¦‹å•é¡Œ

**1. æœå‹™ç„¡æ³•å•Ÿå‹•**

```bash
# æª¢æŸ¥æ—¥èªŒ
railway logs

# æª¢æŸ¥ç’°å¢ƒè®Šé‡
railway variables

# æª¢æŸ¥æ•¸æ“šåº«é€£æ¥
npx prisma db pull
```

**2. æ•¸æ“šåº«é€£æ¥å¤±æ•—**

- æª¢æŸ¥DATABASE_URLæ˜¯å¦æ­£ç¢º
- æª¢æŸ¥æ•¸æ“šåº«æ˜¯å¦é‹è¡Œ
- æª¢æŸ¥ç¶²çµ¡é€£æ¥

**3. AIæœå‹™éŒ¯èª¤**

- æª¢æŸ¥OPENAI_API_KEYæ˜¯å¦æœ‰æ•ˆ
- æª¢æŸ¥APIé™é¡
- æª¢æŸ¥ç¶²çµ¡é€£æ¥

---

## ğŸ“š ç›¸é—œæ–‡æª”

- [å¾Œç«¯æ¶æ§‹è¨­è¨ˆ](./01-å¾Œç«¯æ¶æ§‹è¨­è¨ˆ.md)
- [æ•¸æ“šåº«è¨­è¨ˆ](./02-æ•¸æ“šåº«è¨­è¨ˆ.md)

---

**æ–‡æª”ç‰ˆæœ¬**ï¼šv1.0  
**æœ€å¾Œæ›´æ–°**ï¼š2024å¹´

