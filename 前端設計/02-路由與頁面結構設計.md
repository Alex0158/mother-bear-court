# 熊媽媽法庭 - 路由與頁面結構設計

**項目名稱**：熊媽媽法庭（Mother Bear Court）  
**設計階段**：MVP開發階段  
**文檔版本**：v1.0

---

## 🗺️ 路由架構總覽

### 路由層級結構

```
根路由 (/)
│
├── 公開路由（無需認證）
│   ├── / (首頁)
│   ├── /quick-experience (快速體驗入口)
│   └── /auth/* (認證相關)
│
├── 受保護路由（需登錄）
│   ├── /case/* (案件相關)
│   ├── /judgment/* (判決相關)
│   ├── /reconciliation/* (和好方案)
│   ├── /execution/* (執行追蹤)
│   └── /profile/* (個人中心)
│
└── 特殊路由
    ├── /404 (404頁面)
    └── /500 (500錯誤頁面)
```

---

## 📄 頁面詳細路由定義

### 1. 公開路由

#### 1.1 首頁 (`/`)

**路由配置**：
- **路徑**：`/`
- **組件**：`pages/Home/Index`
- **權限**：公開，無需登錄
- **布局**：完整布局（Header + Footer）

**功能說明**：
- 展示品牌介紹和核心價值
- 提供快速體驗入口
- 引導用戶註冊或登錄
- 展示產品特色和優勢

**頁面元素**：
- 頂部Banner（母熊法官形象 + Slogan）
- 核心功能介紹區塊
- 快速開始按鈕（跳轉到快速體驗）
- 註冊/登錄入口
- 產品特色展示
- 底部Footer

---

#### 1.2 快速體驗 (`/quick-experience`)

**路由配置**：
- **路徑**：`/quick-experience`
- **組件**：`pages/QuickExperience/Index`
- **權限**：公開，無需登錄
- **布局**：簡化布局（無Header，僅Footer）

**子路由**：
- `/quick-experience/create` - 創建案件
- `/quick-experience/result/:id` - 查看判決結果

**功能說明**：
- 零門檻進入，無需註冊
- 單人雙角色介面
- 快速獲得判決結果
- 判決後引導註冊

---

#### 1.3 認證路由 (`/auth/*`)

**路由配置**：
- **基礎路徑**：`/auth`
- **權限**：公開，但已登錄用戶自動跳轉
- **布局**：認證布局（居中卡片式）

**子路由**：

**1.3.1 登錄頁 (`/auth/login`)**
- **組件**：`pages/Auth/Login`
- **功能**：郵箱+密碼登錄，記住我功能
- **跳轉邏輯**：登錄成功後跳轉到首頁或原目標頁面

**1.3.2 註冊頁 (`/auth/register`)**
- **組件**：`pages/Auth/Register`
- **功能**：郵箱註冊，驗證碼驗證，密碼設置
- **流程**：郵箱輸入 → 發送驗證碼 → 驗證碼驗證 → 設置密碼 → 完成註冊

**1.3.3 忘記密碼 (`/auth/forgot-password`)**
- **組件**：`pages/Auth/ForgotPassword`
- **功能**：郵箱重置密碼
- **流程**：輸入郵箱 → 發送重置鏈接 → 設置新密碼

---

### 2. 受保護路由（需登錄）

#### 2.1 案件路由 (`/case/*`)

**路由配置**：
- **基礎路徑**：`/case`
- **權限**：需登錄
- **布局**：完整布局

**子路由**：

**2.1.1 創建案件 (`/case/create`)**
- **組件**：`pages/Case/Create`
- **功能**：創建新案件（完整模式）
- **前置條件**：需配對成功（可選，快速體驗模式不需要）

**2.1.2 案件列表 (`/case/list`)**
- **組件**：`pages/Case/List`
- **功能**：查看所有案件列表
- **篩選**：按狀態、類型、時間篩選
- **排序**：按時間、狀態排序

**2.1.3 案件詳情 (`/case/:id`)**
- **組件**：`pages/Case/Detail`
- **功能**：查看案件詳細信息
- **權限**：僅案件相關用戶可查看

**2.1.4 審理中 (`/case/:id/review`)**
- **組件**：`pages/Case/Review`
- **功能**：查看審理進度，等待判決
- **實時更新**：輪詢或WebSocket更新狀態

---

#### 2.2 判決路由 (`/judgment/*`)

**路由配置**：
- **基礎路徑**：`/judgment`
- **權限**：需登錄
- **布局**：完整布局

**子路由**：

**2.2.1 判決詳情 (`/judgment/:id`)**
- **組件**：`pages/Judgment/Detail`
- **功能**：查看完整判決書
- **內容**：問題分析、判決結果、責任分比例、具體建議

**2.2.2 判決結果 (`/judgment/:id/result`)**
- **組件**：`pages/Judgment/Result`
- **功能**：判決結果展示頁（與詳情頁類似，但更強調結果）
- **操作**：接受/拒絕判決，生成和好方案

---

#### 2.3 和好方案路由 (`/reconciliation/*`)

**路由配置**：
- **基礎路徑**：`/reconciliation`
- **權限**：需登錄
- **布局**：完整布局

**子路由**：

**2.3.1 方案列表 (`/reconciliation/:judgmentId`)**
- **組件**：`pages/Reconciliation/List`
- **功能**：查看該判決的所有和好方案
- **展示**：卡片式展示，支持篩選和排序

**2.3.2 方案詳情 (`/reconciliation/:judgmentId/:id`)**
- **組件**：`pages/Reconciliation/Detail`
- **功能**：查看方案詳細內容
- **操作**：選擇方案、自定義方案、開始執行

---

#### 2.4 執行追蹤路由 (`/execution/*`)

**路由配置**：
- **基礎路徑**：`/execution`
- **權限**：需登錄
- **布局**：完整布局

**子路由**：

**2.4.1 執行看板 (`/execution/dashboard`)**
- **組件**：`pages/Execution/Dashboard`
- **功能**：查看所有執行中的方案
- **展示**：卡片式展示，進度可視化

**2.4.2 打卡頁面 (`/execution/:planId/checkin`)**
- **組件**：`pages/Execution/CheckIn`
- **功能**：執行打卡，記錄執行情況
- **內容**：執行時間、內容、感受、照片

---

#### 2.5 個人中心路由 (`/profile/*`)

**路由配置**：
- **基礎路徑**：`/profile`
- **權限**：需登錄
- **布局**：完整布局（帶側邊欄）

**子路由**：

**2.5.1 個人資料 (`/profile/index`)**
- **組件**：`pages/Profile/Index`
- **功能**：查看和編輯個人資料
- **內容**：基本信息、頭像、偏好設置

**2.5.2 設置 (`/profile/settings`)**
- **組件**：`pages/Profile/Settings`
- **功能**：賬號設置、通知設置、隱私設置

**2.5.3 配對管理 (`/profile/pairing`)**
- **組件**：`pages/Profile/Pairing`
- **功能**：查看配對狀態、生成邀請碼、解除配對

---

### 3. 特殊路由

#### 3.1 404頁面 (`/404`)

**路由配置**：
- **路徑**：`/404`
- **組件**：`pages/NotFound`
- **觸發**：訪問不存在的路由
- **功能**：友好的404提示，引導返回首頁

---

#### 3.2 500錯誤頁面 (`/500`)

**路由配置**：
- **路徑**：`/500`
- **組件**：`pages/Error`
- **觸發**：服務器錯誤
- **功能**：錯誤提示，聯繫支持

---

## 🔐 路由守衛設計

### 守衛類型

**1. 認證守衛（AuthGuard）**
- **功能**：檢查用戶是否已登錄
- **適用路由**：所有受保護路由
- **未登錄處理**：重定向到 `/auth/login`，並保存原目標路由

**2. 配對守衛（PairingGuard）**
- **功能**：檢查用戶是否已配對
- **適用路由**：需要配對的功能（如完整模式創建案件）
- **未配對處理**：重定向到 `/profile/pairing`，提示配對

**3. 案件權限守衛（CasePermissionGuard）**
- **功能**：檢查用戶是否有權限查看該案件
- **適用路由**：`/case/:id`、`/judgment/:id`
- **無權限處理**：重定向到 `/case/list`，提示無權限

---

## 📱 頁面布局設計

### 布局類型

**1. 完整布局（FullLayout）**
- **組成**：Header + Main Content + Footer
- **適用**：大部分頁面
- **特點**：完整的導航和頁腳

**2. 簡化布局（SimpleLayout）**
- **組成**：僅 Main Content + Footer
- **適用**：快速體驗、認證頁面
- **特點**：專注內容，減少干擾

**3. 認證布局（AuthLayout）**
- **組成**：居中卡片式內容
- **適用**：登錄、註冊頁面
- **特點**：居中對齊，視覺聚焦

**4. 側邊欄布局（SidebarLayout）**
- **組成**：Sidebar + Main Content
- **適用**：個人中心、設置頁面
- **特點**：側邊導航，內容區域寬敞

---

## 🔄 頁面跳轉邏輯

### 跳轉場景

**1. 登錄後跳轉**
- **場景**：用戶登錄成功
- **邏輯**：
  - 如果有保存的目標路由，跳轉到目標路由
  - 否則跳轉到首頁

**2. 註冊後跳轉**
- **場景**：用戶註冊成功
- **邏輯**：跳轉到配對頁面，引導配對

**3. 快速體驗後跳轉**
- **場景**：快速體驗獲得判決後
- **邏輯**：
  - 顯示判決結果
  - 提示註冊保存記錄
  - 點擊註冊後跳轉到註冊頁，並保存當前判決ID

**4. 判決後跳轉**
- **場景**：判決生成完成
- **邏輯**：
  - 跳轉到判決結果頁
  - 提示是否生成和好方案
  - 選擇生成後跳轉到和好方案列表

---

## 📊 路由狀態管理

### 路由相關狀態

**當前路由信息**：
```typescript
{
  pathname: string,
  params: Record<string, string>,
  query: Record<string, string>,
  previousPath: string | null,
}
```

**導航歷史**：
- 記錄用戶訪問的路由歷史
- 支持返回上一頁
- 用於分析用戶行為

**路由權限緩存**：
- 緩存路由權限檢查結果
- 避免重複檢查
- 提高性能

---

## 🎯 路由優化策略

### 代碼分割

**路由級別分割**：
- 每個路由頁面獨立打包
- 使用 `React.lazy()` 動態導入
- 減少初始包大小

**組件級別分割**：
- 大型組件使用動態導入
- 按需加載，提高首屏速度

### 預加載策略

**關鍵路由預加載**：
- 首頁、快速體驗等關鍵路由預加載
- 用戶可能訪問的路由提前加載

**懸停預加載**：
- 鏈接懸停時預加載目標頁面
- 提升用戶體驗

### 過渡動畫

**頁面切換動畫**：
- 使用淡入淡出效果
- 保持視覺連貫性
- 提升用戶體驗

---

## 🔍 路由監控

### 路由追蹤

**訪問統計**：
- 記錄每個路由的訪問次數
- 分析用戶行為路徑
- 優化用戶體驗

**性能監控**：
- 監控路由切換時間
- 識別性能瓶頸
- 優化加載速度

**錯誤追蹤**：
- 記錄路由錯誤
- 分析錯誤原因
- 及時修復問題

---

**文檔版本**：v1.0  
**創建日期**：2024年  
**最後更新**：2024年

