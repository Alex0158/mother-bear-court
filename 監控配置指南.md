# ç›£æ§é…ç½®æŒ‡å—

**ç‰ˆæœ¬**ï¼šv1.0  
**æœ€å¾Œæ›´æ–°**ï¼š2024å¹´12æœˆ

---

## ğŸ¯ ç›£æ§ç›®æ¨™

1. **éŒ¯èª¤è¿½è¹¤**ï¼šåŠæ™‚ç™¼ç¾å’Œä¿®å¾©éŒ¯èª¤
2. **æ€§èƒ½ç›£æ§**ï¼šç¢ºä¿ç³»çµ±æ€§èƒ½æ»¿è¶³è¦æ±‚
3. **ç”¨æˆ¶è¡Œç‚º**ï¼šäº†è§£ç”¨æˆ¶ä½¿ç”¨æƒ…æ³
4. **ç³»çµ±å¥åº·**ï¼šç¢ºä¿ç³»çµ±ç©©å®šé‹è¡Œ

---

## ğŸ”´ å¿…é ˆé…ç½®ï¼ˆP0ï¼‰

### 1. SentryéŒ¯èª¤ç›£æ§

#### 1.1 è¨»å†Šå’Œå‰µå»ºé …ç›®

1. è¨ªå• https://sentry.io
2. è¨»å†Šè³¬è™Ÿï¼ˆå…è²»ç‰ˆè¶³å¤ MVPä½¿ç”¨ï¼‰
3. å‰µå»ºçµ„ç¹”ï¼ˆOrganizationï¼‰
4. å‰µå»ºé …ç›®ï¼š
   - å‰ç«¯ï¼šé¸æ“‡ã€ŒReactã€
   - å¾Œç«¯ï¼šé¸æ“‡ã€ŒNode.jsã€

#### 1.2 å‰ç«¯é…ç½®

**å®‰è£ä¾è³´**ï¼š
```bash
cd frontend
npm install @sentry/react
```

**é…ç½®ä»£ç¢¼**ï¼ˆ`frontend/src/main.tsx`ï¼‰ï¼š
```typescript
import * as Sentry from "@sentry/react";

Sentry.init({
  dsn: import.meta.env.VITE_SENTRY_DSN,
  environment: import.meta.env.MODE,
  tracesSampleRate: 1.0, // ç”Ÿç”¢ç’°å¢ƒå»ºè­°0.1
  beforeSend(event, hint) {
    // éæ¿¾æ•æ„Ÿä¿¡æ¯
    if (event.request) {
      delete event.request.cookies;
      delete event.request.headers?.Authorization;
    }
    return event;
  },
});
```

**ç’°å¢ƒè®Šé‡**ï¼ˆ`.env.production`ï¼‰ï¼š
```env
VITE_SENTRY_DSN=https://xxx@sentry.io/xxx
```

#### 1.3 å¾Œç«¯é…ç½®

**å®‰è£ä¾è³´**ï¼š
```bash
cd backend
npm install @sentry/node
```

**é…ç½®ä»£ç¢¼**ï¼ˆ`backend/src/app.ts`ï¼‰ï¼š
```typescript
import * as Sentry from "@sentry/node";

Sentry.init({
  dsn: process.env.SENTRY_DSN,
  environment: process.env.NODE_ENV,
  tracesSampleRate: 1.0, // ç”Ÿç”¢ç’°å¢ƒå»ºè­°0.1
  beforeSend(event, hint) {
    // éæ¿¾æ•æ„Ÿä¿¡æ¯
    if (event.request) {
      delete event.request.cookies;
      delete event.request.headers?.authorization;
    }
    return event;
  },
});
```

**ç’°å¢ƒè®Šé‡**ï¼ˆ`.env`ï¼‰ï¼š
```env
SENTRY_DSN=https://xxx@sentry.io/xxx
```

#### 1.4 é…ç½®å‘Šè­¦è¦å‰‡

åœ¨Sentry Dashboardä¸­è¨­ç½®ï¼š
1. **éŒ¯èª¤å‘Šè­¦**ï¼š
   - æ–°éŒ¯èª¤ç™¼ç”Ÿæ™‚é€šçŸ¥
   - éŒ¯èª¤é »ç‡è¶…éé–¾å€¼æ™‚é€šçŸ¥
   - åš´é‡éŒ¯èª¤ç«‹å³é€šçŸ¥

2. **æ€§èƒ½å‘Šè­¦**ï¼š
   - APIéŸ¿æ‡‰æ™‚é–“è¶…éé–¾å€¼
   - æ•¸æ“šåº«æŸ¥è©¢æ™‚é–“éé•·

---

### 2. å¥åº·æª¢æŸ¥ç«¯é»

#### 2.1 å¾Œç«¯å¥åº·æª¢æŸ¥

**å¯¦ç¾**ï¼ˆ`backend/src/routes/health.routes.ts`ï¼‰ï¼š
```typescript
import { Router, Request, Response } from 'express';
import prisma from '../config/database';

const router = Router();

router.get('/health', async (req: Request, res: Response) => {
  try {
    // æª¢æŸ¥æ•¸æ“šåº«é€£æ¥
    await prisma.$queryRaw`SELECT 1`;
    
    res.json({
      status: 'healthy',
      timestamp: new Date().toISOString(),
      uptime: process.uptime(),
      database: 'connected',
    });
  } catch (error) {
    res.status(503).json({
      status: 'unhealthy',
      timestamp: new Date().toISOString(),
      database: 'disconnected',
      error: error instanceof Error ? error.message : 'Unknown error',
    });
  }
});

export default router;
```

**ä½¿ç”¨**ï¼š
- éƒ¨ç½²å¹³å°è‡ªå‹•å¥åº·æª¢æŸ¥
- ç›£æ§å·¥å…·å®šæœŸæª¢æŸ¥
- æ‰‹å‹•æª¢æŸ¥ï¼š`curl https://your-api.com/health`

---

## ğŸŸ¡ å»ºè­°é…ç½®ï¼ˆP1ï¼‰

### 3. æ€§èƒ½ç›£æ§

#### 3.1 å‰ç«¯æ€§èƒ½ç›£æ§

**ä½¿ç”¨Web Vitals**ï¼š
```typescript
import { onCLS, onFID, onLCP } from 'web-vitals';

function sendToAnalytics(metric: any) {
  // ç™¼é€åˆ°ç›£æ§æœå‹™
  console.log(metric);
}

onCLS(sendToAnalytics);
onFID(sendToAnalytics);
onLCP(sendToAnalytics);
```

#### 3.2 å¾Œç«¯æ€§èƒ½ç›£æ§

**ä½¿ç”¨Sentry Performance**ï¼š
- Sentryè‡ªå‹•è¿½è¹¤APIæ€§èƒ½
- å¯ä»¥æŸ¥çœ‹æ…¢æŸ¥è©¢
- å¯ä»¥æŸ¥çœ‹æ•¸æ“šåº«æ€§èƒ½

---

### 4. æ—¥èªŒèšåˆ

#### 4.1 ä½¿ç”¨Winstonï¼ˆå·²å¯¦ç¾ï¼‰

**é…ç½®**ï¼ˆ`backend/src/config/logger.ts`ï¼‰ï¼š
- å·²é…ç½®çµæ§‹åŒ–æ—¥èªŒ
- å·²é…ç½®æ—¥èªŒç´šåˆ¥
- å·²é…ç½®æ—¥èªŒæ–‡ä»¶è¼¸å‡º

#### 4.2 æ—¥èªŒèšåˆæœå‹™ï¼ˆå¯é¸ï¼‰

**é¸é …**ï¼š
- **Logtail**ï¼šå…è²»é¡åº¦å……è¶³
- **Papertrail**ï¼šç°¡å–®æ˜“ç”¨
- **Datadog**ï¼šåŠŸèƒ½å¼·å¤§ï¼ˆä»˜è²»ï¼‰

---

## ğŸŸ¢ å¯é¸é…ç½®ï¼ˆP2ï¼‰

### 5. ç”¨æˆ¶è¡Œç‚ºåˆ†æ

#### 5.1 Google Analytics

**å®‰è£**ï¼š
```bash
npm install react-ga4
```

**é…ç½®**ï¼š
```typescript
import ReactGA from 'react-ga4';

ReactGA.initialize('G-XXXXXXXXXX');
```

#### 5.2 è‡ªå®šç¾©äº‹ä»¶è¿½è¹¤

**é—œéµäº‹ä»¶**ï¼š
- ç”¨æˆ¶è¨»å†Š
- æ¡ˆä»¶å‰µå»º
- åˆ¤æ±ºæŸ¥çœ‹
- å’Œå¥½æ–¹æ¡ˆç”Ÿæˆ

---

### 6. å¯¦æ™‚ç›£æ§å„€è¡¨æ¿

**å·¥å…·é¸é …**ï¼š
- **Grafana**ï¼šé–‹æºï¼ŒåŠŸèƒ½å¼·å¤§
- **Datadog**ï¼šå•†æ¥­è§£æ±ºæ–¹æ¡ˆ
- **New Relic**ï¼šAPMå·¥å…·

---

## ğŸ“Š ç›£æ§æŒ‡æ¨™

### é—œéµæŒ‡æ¨™ï¼ˆå¿…é ˆç›£æ§ï¼‰

1. **éŒ¯èª¤ç‡**
   - ç›®æ¨™ï¼š< 1%
   - å‘Šè­¦é–¾å€¼ï¼š> 5%

2. **APIéŸ¿æ‡‰æ™‚é–“**
   - ç›®æ¨™ï¼š< 500msï¼ˆéAIï¼‰
   - å‘Šè­¦é–¾å€¼ï¼š> 2ç§’

3. **AIåˆ¤æ±ºç”Ÿæˆæ™‚é–“**
   - ç›®æ¨™ï¼š< 60ç§’
   - å‘Šè­¦é–¾å€¼ï¼š> 120ç§’

4. **ç³»çµ±å¯ç”¨æ€§**
   - ç›®æ¨™ï¼š> 99%
   - å‘Šè­¦é–¾å€¼ï¼š< 95%

5. **æ•¸æ“šåº«é€£æ¥**
   - ç›®æ¨™ï¼šæ­£å¸¸é€£æ¥
   - å‘Šè­¦ï¼šé€£æ¥å¤±æ•—

---

## ğŸ”” å‘Šè­¦é…ç½®

### å‘Šè­¦è¦å‰‡

1. **éŒ¯èª¤å‘Šè­¦**
   - æ–°éŒ¯èª¤ç™¼ç”Ÿï¼šç«‹å³é€šçŸ¥
   - éŒ¯èª¤é »ç‡ > 10æ¬¡/åˆ†é˜ï¼šé€šçŸ¥
   - åš´é‡éŒ¯èª¤ï¼ˆ500ï¼‰ï¼šç«‹å³é€šçŸ¥

2. **æ€§èƒ½å‘Šè­¦**
   - APIéŸ¿æ‡‰æ™‚é–“ > 2ç§’ï¼šé€šçŸ¥
   - æ•¸æ“šåº«æŸ¥è©¢æ™‚é–“ > 1ç§’ï¼šé€šçŸ¥
   - ç³»çµ±å¯ç”¨æ€§ < 95%ï¼šç«‹å³é€šçŸ¥

3. **è³‡æºå‘Šè­¦**
   - å…§å­˜ä½¿ç”¨ > 80%ï¼šé€šçŸ¥
   - CPUä½¿ç”¨ > 80%ï¼šé€šçŸ¥
   - ç£ç›¤ä½¿ç”¨ > 80%ï¼šé€šçŸ¥

---

## ğŸ“ ç›£æ§æª¢æŸ¥æ¸…å–®

### éƒ¨ç½²å‰
- [ ] Sentryé …ç›®å‰µå»º
- [ ] Sentry DSNé…ç½®
- [ ] å¥åº·æª¢æŸ¥ç«¯é»å¯¦ç¾
- [ ] å‘Šè­¦è¦å‰‡è¨­ç½®

### éƒ¨ç½²å¾Œ
- [ ] éŒ¯èª¤ç›£æ§æ­£å¸¸
- [ ] æ€§èƒ½ç›£æ§æ­£å¸¸
- [ ] å‘Šè­¦é€šçŸ¥æ­£å¸¸
- [ ] æ—¥èªŒè¨˜éŒ„æ­£å¸¸

---

## ğŸ› ï¸ æ•…éšœæ’æŸ¥

### å•é¡Œ1ï¼šSentryæœªæ”¶åˆ°éŒ¯èª¤

**æª¢æŸ¥**ï¼š
1. DSNæ˜¯å¦æ­£ç¢º
2. ç¶²çµ¡é€£æ¥æ˜¯å¦æ­£å¸¸
3. Sentryé …ç›®æ˜¯å¦å•Ÿç”¨
4. éŒ¯èª¤æ˜¯å¦è¢«éæ¿¾

### å•é¡Œ2ï¼šå‘Šè­¦æœªè§¸ç™¼

**æª¢æŸ¥**ï¼š
1. å‘Šè­¦è¦å‰‡æ˜¯å¦æ­£ç¢º
2. é€šçŸ¥æ¸ é“æ˜¯å¦é…ç½®
3. é–¾å€¼è¨­ç½®æ˜¯å¦åˆç†

---

**æœ€å¾Œæ›´æ–°**ï¼š2024å¹´12æœˆ



